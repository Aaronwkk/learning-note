# async defer script的区别

在HTML中，`<script>`标签用于嵌入或链接JavaScript文件。为了优化页面加载速度和脚本执行顺序，`<script>`标签可以包含`async`和`defer`两个属性，这两个属性都用于改变脚本的加载方式，使其不会阻塞页面的解析，但它们之间存在一些关键差异：

### async
- **异步加载与执行**：带有`async`属性的脚本会异步加载，这意味着它们不会阻塞页面解析，也不会等待其他脚本或页面资源加载完成。一旦脚本下载完毕，它将立即执行，无论页面是否已经完成解析。
- **执行顺序无保障**：多个带有`async`属性的脚本，它们的执行顺序无法保证，哪个脚本先下载完成就先执行哪个，这可能导致依赖问题，因此适用于相互之间没有依赖关系的脚本。
- **DOMContentLoaded事件**：`async`脚本可能在`DOMContentLoaded`事件触发之前或之后执行，因为它们不等待文档解析完成。

### defer
- **异步加载，顺序执行**：同样地，带有`defer`属性的脚本也会异步加载，不阻塞页面解析。不同的是，所有带有`defer`的脚本会按照在文档中出现的顺序进行执行。
- **执行时机**：所有`defer`脚本会在HTML文档解析完成后，DOMContentLoaded事件触发之前执行。这意味着脚本会等待直到DOM构建完成，但又不需要等到其他如图片等资源加载完毕。
- **依赖管理**：由于执行顺序有保障，`defer`适用于那些有执行顺序要求或者相互依赖的脚本。

### 应用场景
- **async** 适用于那些不影响页面初次渲染或彼此间没有依赖关系的脚本，比如分析追踪脚本或第三方库，这些脚本往往不需要等待页面完全准备就绪就可以运行。
- **defer** 更适用于那些需要在页面渲染前执行，但又必须保持执行顺序的脚本，例如页面初始化代码或者影响DOM操作的库。

总之，选择`async`还是`defer`主要取决于脚本是否需要按照特定顺序执行以及是否依赖于完整的DOM结构。