#### webpack 打包性能瓶颈

#### 可视化方案分析

- webpack-bundle-analyzer

webpack-bundle-analyzer 扫描 bundle 并构建其内部内容的可视化。使用此可视化来查找大的或不必要的依赖项。

具体来说，使用 webpack-bundle-analyzer 能可视化的反映：

打包出的文件中都包含了什么；
每个文件的尺寸在总体中的占比，哪些文件尺寸大，思考一下，为什么那么大，是否有替换方案，是否使用了它包含的所有代码；
模块之间的包含关系；
是否有重复的依赖项，是否存在一个库在多个文件中重复？ 或者捆绑包中是否具有同一库的多个版本？
是否有相似的依赖库， 尝试使用一种依赖库实现相似的功能。
每个文件的压缩后的大小。

- 官方可视化分析工具 Webapck Analyse

Modules ：展示所有的模块，每个模块对应一个文件。并且还包含所有模块之间的依赖关系图、模块路径、模块ID、模块所属 Chunk、模块大小；

Chunks ：展示所有的代码块，一个代码块中包含多个模块。并且还包含代码块的ID、名称、大小、每个代码块包含的模块数量，以及代码块之间的依赖关系图；

Assets ：展示所有输出的文件资源，包括 .js、.css、图片等。并且还包括文件名称、大小、该文件来自哪个代码块；

#### cache-loader

在一些性能开销较大的 loader 之前添加 cache-loader，将结果缓存中磁盘中。默认保存在 node_modueles/.cache/cache-loader 目录下

#### hard-source-webpack-plugin

当前选中的代码是一个插件的名称，即 `hard-source-webpack-plugin`。这个插件是一个 Webpack 插件，它的主要作用是在开发过程中，通过缓存和优化构建过程中的中间件提高开发效率。它的工作原理是在首次构建时，将构建过程中的中间产物（如模块、依赖图等）缓存到本地磁盘或内存中。这样，在后续的构建中，Webpack 可以直接使用缓存中的数据，从而避免了重复的构建过程，显著提高了构建速度。

在实际使用中，只需要在 Webpack 配置文件中引入并配置这个插件，它就会在构建过程中自动生效。通过这种方式，开发者可以在开发过程中节省宝贵的时间，提高开发效率。

#### speed-measure-webpack-plugin

插件可以测量各个插件和loader所花费的时间，使用之后，构建时，会得到类似下面这样的信息

#### noParse

如果一些第三方模块没有AMD/CommonJS规范版本，可以使用 noParse 来标识这个模块，这样 Webpack 会引入这些模块，但是不进行转化和解析，从而提升 Webpack 的构建性能 ，例如：jquery 、lodash。

#### DllPlugin

“DllPlugin”是一个与 Webpack 相关的插件。它主要用于将一些模块提前打包成动态链接库（DLL），从而在后续的构建中提高构建速度。可以将一些不常变动的模块（例如第三方库）通过这个插件进行单独打包，在实际构建时直接引用这些已经打包好的 DLL，避免重复处理，节省构建时间。 
这里我们将 react 和 react-dom 单独打包成一个动态链接库。

#### HardSourceWebpackPlugin 和 cache-loader 的区别 可以具体说明下吗？

`HardSourceWebpackPlugin` 和 `cache-loader` 都是用来提高 Webpack 构建性能的工具，但它们的工作方式和适用场景有所不同。

### HardSourceWebpackPlugin

`HardSourceWebpackPlugin` 是一个 Webpack 插件，它通过缓存中间编译结果来加速构建过程。它在硬盘上存储模块的编译结果，并在下次构建时重用这些结果，从而避免了重复执行相同的编译工作。这个插件尤其适合在开发环境中使用，因为它可以显著减少每次保存代码后重新构建的时间。

**优点**：
- 硬链接缓存：它不会复制文件，而是创建硬链接，这样可以节省磁盘空间。
- 缩短构建时间：特别是在多次构建之间源代码没有变化的情况下，可以极大地加快构建速度。

**缺点**：
- 内存占用：由于硬链接的存在，如果构建环境的内存管理不佳，可能会遇到性能瓶颈。
- 不透明性：它的工作机制可能对一些开发者来说不够直观。

### cache-loader

`cache-loader` 是一个 Webpack 加载器，它的作用是在磁盘上缓存加载器的输出结果。当同一个输入再次被处理时，它会从缓存中读取结果，而不是重新运行加载器。这对于那些计算密集型的加载器特别有用，比如 Babel 或者 TypeScript 加载器。

**优点**：
- 灵活性：它可以与其他加载器组合使用，适用于各种不同的场景。
- 节省计算资源：避免了不必要的计算，尤其是在构建大型项目时效果明显。

**缺点**：
- 磁盘空间：缓存会占用一定的磁盘空间。
- 配置复杂度：正确配置 cache-loader 可能需要更多的时间和精力。

### 示例

假设你正在使用 Webpack 并且想要优化 Babel 的构建时间，你可以这样配置 `cache-loader`：

两者都可以显著改善构建性能，但是 `cache-loader` 更加灵活，可以针对特定的加载器进行优化，而 `HardSourceWebpackPlugin` 则是一个全局的解决方案，对整个构建流程进行优化。选择哪一个取决于你的具体需求和构建环境的特性。

[带你深度解锁Webpack系列(优化篇)](https://juejin.cn/post/6844904093463347208#heading-7)